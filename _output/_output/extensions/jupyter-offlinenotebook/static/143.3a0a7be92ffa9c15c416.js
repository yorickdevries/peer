"use strict";(self.webpackChunkjupyter_offlinenotebook=self.webpackChunkjupyter_offlinenotebook||[]).push([[143],{143:(o,e,n)=>{n.r(e),n.d(e,{OfflineNotebookButtons:()=>x,default:()=>E});var t=n(129),l=n(706),r=n(447),a=n(538),i=n(3),s=n.n(i);let c=null,d=null,f=null,u=null,p=null;class b extends(s()){constructor(){super("jupyter-offlinenotebook"),this.version(1).stores({offlinenotebook:"pk, repoid, name, type"}),this.offlinenotebook=this.table("offlinenotebook")}}function k(){return p||(p=new b,console.log("offline-notebook: Opened IndexedDB")),p}function h(){const o=document.createElement("a");document.body.appendChild(o),o.href=f,o.target="_blank",o.style.display="none",o.click(),document.body.removeChild(o)}function w(){return c}function g(){return d}function m(){return u}var y=n(554),B=n.n(y);const v="jp-OfflineNotebookToolbarIcon",C={activate:function(o){console.log("Activating jupyter-offlinenotebook JupyterLab extension");const e=r.PageConfig.getBaseUrl();B().getJSON(e+"offlinenotebook/config",(o=>{!function(o){c=o.repoid,c?console.log("offline-notebook repoid: "+c):console.log("offline-notebook repoid not found, disabled"),d=o.binder_repo_label||"Repo",console.log("offline-notebook repoLabel: "+d),f=o.binder_ref_url,console.log("offline-notebook binderRefUrl: "+f),u=o.binder_persistent_url,console.log("offline-notebook binderPersistentUrl: "+u)}(o)})),o.docRegistry.addWidgetExtension("Notebook",new x)},id:"offlinenotebook:offlineNotebookButtons",autoStart:!0};class x{createNew(o,e){const n=[];if(n.push(["downloadVisible",new a.ToolbarButton({className:"downloadVisible",iconClass:"fas fa-download "+v,onClick:()=>{!function(o){var e;const n=o.context.path.replace(/.*\//,""),t=null===(e=o.content.model)||void 0===e?void 0:e.toJSON();if(!t){const o="Content model is null";throw(0,a.showErrorMessage)("Local storage error",o),o}!function(o,e){const n=new Blob([JSON.stringify(e)],{type:"application/x-ipynb+json"}),t=window.URL.createObjectURL(n),l=document.createElement("a");document.body.appendChild(l),l.href=t,l.style.display="none",l.download=o,console.log("offlinenotebook: "+o,n),l.click(),window.URL.revokeObjectURL(t),document.body.removeChild(l)}(n,t)}(o)},tooltip:"Download visible",label:"Download"})]),w()&&(n.push(["saveToBrowser",new a.ToolbarButton({className:"saveToBrowser",iconClass:"fas fa-cloud-download-alt "+v,onClick:()=>{!function(o){var e;const n=o.context.path,t=null===(e=o.content.model)||void 0===e?void 0:e.toJSON();if(!t){const o="Content model is null";throw(0,a.showErrorMessage)("Local storage error",o),o}const l=N(n);!function(o,e,n,t){const r="repoid:"+c+" path:"+o;k().offlinenotebook.put({pk:r,repoid:c,name:o.replace(/.*\//,""),path:o,format:"json",type:"notebook",content:e}).then((o=>(o=>(console.log("offline-notebook saved: ",o),(0,a.showDialog)({title:"Notebook saved to browser storage",body:l,buttons:[a.Dialog.okButton()]})))(o))).catch((o=>(o=>{throw(0,a.showErrorMessage)("Local storage IndexedDB error",o),o})(o)))}(n,t)}(o)},tooltip:"Save to browser storage"})]),n.push(["loadFromBrowser",new a.ToolbarButton({className:"loadFromBrowser",iconClass:"fas fa-cloud-upload-alt "+v,onClick:()=>{!function(o){const e=o.context.path,n=N(e),t="repoid:"+w()+" path:"+e;!function(o,e,n){const t="repoid:"+c+" path:"+o;k().offlinenotebook.get(t).then((o=>e(o))).catch((o=>(o=>{throw(0,a.showErrorMessage)("Local storage IndexedDB error",o),o})(o)))}(e,(e=>{if(e)return console.log("offline-notebook found "+t),(0,a.showDialog)({title:"This will replace your current notebook with",body:n,buttons:[a.Dialog.cancelButton(),a.Dialog.warnButton({label:"OK"})]}).then((n=>{n.button.accept&&!o.context.isDisposed&&("content"in e?o.context.model.fromJSON(e.content):(0,a.showErrorMessage)("Invalid notebook",'"content" not found'))}));console.log("offline-notebook not found "+t),(0,a.showErrorMessage)("Notebook not found in browser storage",t)}))}(o)},tooltip:"Restore from browser storage"})])),f){const o={GitHub:"fab fa-github",GitLab:"fab fa-gitlab",Git:"fab fa-git"};n.push(["openRepo",new a.ToolbarButton({className:"openRepo",iconClass:(o[g()]||"fas fa-external-link-alt")+" "+v,onClick:h,tooltip:"Visit Binder repository",label:g()})])}return m()&&n.push(["linkToBinder",new a.ToolbarButton({className:"linkToBinder",iconClass:"fas fa-link "+v,onClick:()=>{!function(o){const e=o.context.path,n=m()+"?urlpath="+encodeURIComponent("lab/tree/"+e);(0,a.showDialog)({title:"Share Binder link",body:new D(n),buttons:[a.Dialog.okButton()]})}(o)},tooltip:"Link to this Binder",label:"Binder"})]),n.reverse(),n.forEach((e=>{o.toolbar.insertItem(9,e[0],e[1])})),new t.DisposableDelegate((()=>{n.forEach((o=>{o[1].dispose()}))}))}}function N(o){return"repoid: "+w()+" path: "+o}class D extends l.Widget{constructor(o){super({node:L(o)})}}function L(o){const e=B()("<div/>",{style:"flex-direction: row;","data-url":o}).append(B()("<pre/>",{text:o,style:"margin: 0; white-space: pre-wrap; word-break: break-all;"})),n=B()("<button/>",{title:"Copy binder link to clipboard","data-url":o}).click((()=>{!function(o){const e=B()("<input>");B()(o).parent().append(e),e.val(B()(o).data("url")).select(),document.execCommand("copy"),e.remove()}(n)}));return n.append(B()("<i/>",{class:"fas fa-clipboard"})),e.append(n),e.get(0)}const E=C}}]);